{% extends "base.html" %}

{% block title %}Post-Flight Submit - NAV Scoring{% endblock %}

{% block navbar %}
<div class="navbar">
    <div class="navbar-brand">
        <button class="hamburger" id="hamburgerBtn">â˜°</button>
        <h1>NAV Scoring - Post-Flight</h1>
    </div>
    <div class="navbar-links" id="navbarLinks">
        <span>{{ member_name }}</span>
        <a href="/dashboard">Dashboard</a>
        <a href="/prenav">Pre-NAV</a>
        <a href="/flight">Post-NAV</a>
        <a href="/results">Results</a>
        <a href="/profile">Profile</a>
        <a href="/logout">Logout</a>
    </div>
</div>
{% endblock %}

{% block content %}
<h2>Submit Flight Results</h2>

{% if error %}
<div class="error" style="padding: 15px; margin: 15px 0; border: 1px solid #d32f2f; background-color: #ffebee; color: #c62828; border-radius: 4px;">
    <strong>Error:</strong> {{ error }}
</div>
{% endif %}

<div class="info">
    <strong>Instructions:</strong><br>
    1. Select your pre-flight submission<br>
    2. Select the start gate you used<br>
    3. Upload your GPX file from the flight<br>
    4. Enter actual fuel burn and secrets missed<br>
    5. Get instant score!
</div>

<form method="POST" action="/flight" enctype="multipart/form-data">
    <div class="form-group">
        <label for="prenav_id">Select Pre-Flight Submission to Score:</label>
        <select id="prenav_id" name="prenav_id" required>
            <option value="">-- Select Submission --</option>
            {% for prenav in open_prenavs %}
            <option value="{{ prenav.id }}">{{ prenav.display }}</option>
            {% endfor %}
        </select>
        {% if not open_prenavs %}
        <small style="color: #999;">No open pre-flight submissions found. Submit a pre-flight plan first.</small>
        {% endif %}
    </div>
    
    <div class="form-group">
        <label for="start_gate_id">Start Gate:</label>
        <select id="start_gate_id" name="start_gate_id" required>
            <option value="">-- Select Start Gate --</option>
            {% for gate in start_gates %}
            <option value="{{ gate.id }}">{{ gate.name }}</option>
            {% endfor %}
        </select>
    </div>
    
    <div class="form-group">
        <label for="gpx_file">GPX File:</label>
        <input type="file" id="gpx_file" name="gpx_file" accept=".gpx" required>
        <small style="color: #666;">Upload the GPX track file from your flight</small>
    </div>
    
    <div class="form-group">
        <label for="actual_fuel">Actual Fuel Burn (gallons):</label>
        <input type="number" id="actual_fuel" name="actual_fuel" 
               step="0.1" min="0" placeholder="8.5" required>
    </div>
    
    <div class="form-group">
        <label for="secrets_checkpoint">Checkpoint Secrets Missed:</label>
        <input type="number" id="secrets_checkpoint" name="secrets_checkpoint" 
               min="0" value="0" required>
        <small style="color: #666;">Count of checkpoint secrets you missed</small>
    </div>
    
    <div class="form-group">
        <label for="secrets_enroute">Enroute Secrets Missed:</label>
        <input type="number" id="secrets_enroute" name="secrets_enroute" 
               min="0" value="0" required>
        <small style="color: #666;">Count of enroute secrets you missed</small>
    </div>
    
    <button type="submit">Submit & Score Flight</button>
</form>
{% endblock %}
