{% extends "base.html" %}

{% block title %}Select Pre-Flight to Complete - NAV Scoring{% endblock %}

{% block extra_css %}
<style>
.button-danger {
    background-color: #8B0015;
    color: white;
    padding: 0.5rem 1rem;
    text-decoration: none;
    border-radius: 4px;
    border: none;
    cursor: pointer;
    font-size: 0.85rem;
    display: inline-block;
}
.button-danger:hover {
    background-color: #6B0010;
}
.card {
    max-width: none;
    width: 95%;
}
</style>
{% endblock %}

{% block navbar %}
<div class="navbar">
    <div class="navbar-brand">
        <button class="hamburger" id="hamburgerBtn">☰</button>
        <h1>NAV Scoring - Select Submission</h1>
    </div>
    <div class="navbar-links" id="navbarLinks">
        <a href="/dashboard">Dashboard</a>
        <a href="/profile">Profile</a>
        <a href="/logout">Logout</a>
    </div>
</div>
{% endblock %}

{% block content %}
<h2>Select Pre-Flight Submission to Complete</h2>
<div style="margin-bottom: 1.5rem;">
    <a href="/dashboard" style="display: inline-block; background: #8B0015; color: white; padding: 0.75rem 1.5rem; border-radius: 5px; text-decoration: none; transition: transform 0.2s;">← Return to Dashboard</a>
</div>


{% if message %}
<div class="success" style="padding: 15px; margin: 15px 0; border: 1px solid #4caf50; background-color: #e8f5e9; color: #2e7d32; border-radius: 4px;">
    {{ message }}
</div>
{% endif %}

<div class="info">
    <strong>Instructions:</strong><br>
    Select a pre-flight submission from the table below to complete post-flight scoring. You'll be able to upload your GPX file and enter flight results.
</div>

{% if open_prenavs %}
<table class="results-table" style="margin-top: 1.5rem;">
    <thead>
        <tr>
            <th>Date/Time</th>
            <th>NAV Route</th>
            <th>Pairing</th>
            <th>Total Time</th>
            <th>Fuel Estimate</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for prenav in open_prenavs %}
        <tr>
            <td>{{ prenav.submitted_at_display }}</td>
            <td>{{ prenav.nav_name }}</td>
            <td>
                <strong>{{ prenav.pilot_name }}</strong> (Pilot)<br>
                <strong>{{ prenav.observer_name }}</strong> (Observer)
            </td>
            <td>{{ prenav.total_time_display }}</td>
            <td>{{ prenav.fuel_estimate|round(1) }} gal</td>
            <td style="white-space: nowrap;">
                <a href="/flight?prenav_id={{ prenav.id }}" class="button" style="font-size: 0.85rem; padding: 6px 12px; display: inline-block;">
                    ✓ Select
                </a>
                {% if is_admin %}
                <a href="/flight/delete/{{ prenav.id }}/confirm" class="button-danger" style="font-size: 0.85rem; padding: 6px 12px; display: inline-block;">
                    Delete
                </a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div style="margin-top: 2rem;">
    <a href="/dashboard" class="button" style="display: inline-block; margin-right: 10px;">← Back to Dashboard</a>
    <a href="/prenav" class="button" style="display: inline-block;">+ New Pre-Flight</a>
</div>
{% else %}
<div class="info" style="margin-top: 1.5rem; padding: 20px; background-color: #e3f2fd; border-left: 4px solid #2196f3;">
    <strong>No open pre-flight submissions found.</strong><br>
    Submit a pre-flight plan first to complete post-flight scoring.
    <div style="margin-top: 1rem;">
        <a href="/prenav" class="button">Submit Pre-Flight Plan</a>
        <a href="/dashboard" class="button" style="margin-left: 10px;">Back to Dashboard</a>
    </div>
</div>
{% endif %}
{% endblock %}
